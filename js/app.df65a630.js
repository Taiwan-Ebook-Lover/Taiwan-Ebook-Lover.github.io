(function(t){function e(e){for(var o,i,n=e[0],l=e[1],c=e[2],d=0,h=[];d<n.length;d++)i=n[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&h.push(a[i][0]),a[i]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);u&&u(e);while(h.length)h.shift()();return r.push.apply(r,c||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],o=!0,n=1;n<s.length;n++){var l=s[n];0!==a[l]&&(o=!1)}o&&(r.splice(e--,1),t=i(i.s=s[0]))}return t}var o={},a={app:0},r=[];function i(e){if(o[e])return o[e].exports;var s=o[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=o,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=e,n=n.slice();for(var c=0;c<n.length;c++)e(n[c]);var u=l;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"01c7":function(t,e,s){t.exports=s.p+"img/ebook-logo-bg.6e557c1b.svg"},"109b":function(t,e,s){},"22e3":function(t,e,s){},"2d0a":function(t,e,s){},"40ca":function(t,e,s){t.exports=s.p+"img/play-store-badge.7733e12d.svg"},"452c":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var o=s("2b0e"),a=(s("5363"),s("f309"));o["a"].use(a["a"]);var r=new a["a"]({icons:{iconfont:"mdi"}}),i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-app",[o("v-toolbar",{staticClass:"elevation-0",attrs:{short:"",color:t.toolBarColor}},[o("v-toolbar-title",{staticClass:"home",class:t.toolBarTitleClass,on:{click:t.redirectHome}},[o("v-avatar",{staticClass:"ma-2",attrs:{tile:"",size:"40"}},[o("img",{attrs:{src:s("9c6c"),alt:"ebook-logo"}})]),o("span",{staticClass:"hidden-xs-only"},[t._v("台灣電子書搜尋")])],1),o("v-spacer"),o("v-toolbar-items",{staticClass:"hidden-sm-and-down mr-2"},[o("a",{staticClass:"img-flex",attrs:{href:"https://denkeni.medium.com/farewell-ebooktw-ios-dea6fd5e542b"}},[o("img",{attrs:{src:s("ddae"),alt:"app-store"}})])]),o("v-toolbar-items",{staticClass:"hidden-sm-and-down mr-2"},[o("a",{staticClass:"img-flex",attrs:{href:"https://play.google.com/store/apps/details?id=liou.rayyuan.ebooksearchtaiwan"}},[o("img",{attrs:{src:s("40ca"),alt:"play-store"}})])]),o("v-toolbar-items",{staticClass:"hidden-md-and-up mr-2"},[o("v-btn",{class:t.fontColor,on:{click:function(e){t.isDialogShow=!0}}},[t._v("Get App")])],1)],1),o("router-view",{class:t.routeViewBackgoundColor}),o("v-dialog",{attrs:{"max-width":"350"},model:{value:t.isDialogShow,callback:function(e){t.isDialogShow=e},expression:"isDialogShow"}},[o("v-card",[o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",{attrs:{"mx-4":"","my-4":"",xs12:""}},[o("a",{attrs:{href:"https://denkeni.medium.com/farewell-ebooktw-ios-dea6fd5e542b"}},[o("v-img",{attrs:{src:s("ddae"),alt:"app-store"}})],1)]),o("v-flex",{attrs:{"mx-4":"","mb-4":"",xs12:""}},[o("a",{attrs:{href:"https://play.google.com/store/apps/details?id=liou.rayyuan.ebooksearchtaiwan"}},[o("v-img",{attrs:{src:s("40ca"),alt:"play-store"}})],1)])],1)],1)],1)],1)},n=[],l={name:"ebook-search",computed:{toolBarColor:function(){return"/"===this.$route.path?"#f5f5f5":"#0eb29a"},fontColor:function(){return"/"===this.$route.path?"grey--text text--darken-1":"grey--text"},routeViewBackgoundColor:function(){return"/"===this.$route.path?"bg-grey height-100":"height-100"},toolBarTitleClass:function(){return"/"===this.$route.path?"disable-all":"white--text"}},data:function(){return{isDialogShow:!1}},methods:{redirectHome:function(){this.$router.push({path:"/"})}}},c=l,u=(s("eca2"),s("b0a0"),s("2877")),d=s("6544"),h=s.n(d),p=s("7496"),f=s("8212"),m=s("8336"),v=s("b0af"),b=s("169a"),k=s("0e8f"),g=s("adda"),x=s("a722"),_=s("2fa4"),y=s("71d9"),w=s("2a7f"),C=Object(u["a"])(c,i,n,!1,null,"396650d4",null),S=C.exports;h()(C,{VApp:p["a"],VAvatar:f["a"],VBtn:m["a"],VCard:v["a"],VDialog:b["a"],VFlex:k["a"],VImg:g["a"],VLayout:x["a"],VSpacer:_["a"],VToolbar:y["a"],VToolbarItems:w["a"],VToolbarTitle:w["b"]});var B=s("8c4f"),V=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-container",{attrs:{"text-md-center":"","text-sm-center":"","text-xs-center":"",fluid:""}},[o("v-layout",{attrs:{row:"",wrap:"","mt-5":""}},[o("v-flex",{attrs:{lg2:"","offset-lg5":"",sm4:"","offset-sm4":"",xs6:"","offset-xs3":""}},[o("v-img",{attrs:{src:s("01c7"),alt:"ebook-logo","aspect-ratio":"1"}})],1),o("v-flex",{attrs:{"my-2":"",xs12:""}},[o("div",{staticClass:"display-2 grey--text text--darken-3"},[t._v("台灣電子書搜尋")])]),o("v-flex",{attrs:{"my-3":"",lg6:"","offset-lg3":"",sm8:"","offset-sm2":""}},[o("v-form",{ref:"form",on:{submit:function(e){return e.preventDefault(),t.redirectToSearch(e)}}},[o("v-text-field",{attrs:{placeholder:"搜尋您想比價的電子書名關鍵字或 ISBN","append-icon":"search",solo:"",clearable:"","hide-details":""},on:{"click:append":t.redirectToSearch},model:{value:t.searchWord,callback:function(e){t.searchWord=e},expression:"searchWord"}})],1)],1),o("v-flex",{attrs:{lg6:"","offset-lg3":"",sm8:"","offset-sm2":""}},[o("v-select",{attrs:{items:t.validBookstores,"item-text":"displayName","item-value":"id",chips:"",label:"選擇書店","prepend-icon":"filter_list",multiple:"",clearable:""},scopedSlots:t._u([{key:"selection",fn:function(e){var s=e.item,a=e.index;return[o("v-chip",{attrs:{close:""},on:{"click:close":function(e){return t.remove(a)}}},[o("span",[t._v(t._s(s.displayName))])])]}}]),model:{value:t.selectedBookstores,callback:function(e){t.selectedBookstores=e},expression:"selectedBookstores"}})],1),o("v-flex",{attrs:{xs12:""}},[o("div",{staticClass:"headline grey--text"},[o("span",{staticClass:"hidden-xs-only"},[o("i",{staticClass:"fab fa-twitter"}),t._v(" 在"),o("a",{staticClass:"theme-color",attrs:{href:"https://twitter.com/TaiwanEBook"}},[t._v("推特")]),t._v("上追蹤我們 ")]),o("span",{staticClass:"hidden-xs-only mx-4 vertical-divider"}),o("span",[t._v(" 看看支援哪 "),o("v-tooltip",{attrs:{bottom:"",color:"white","max-width":"420"},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,a=e.attrs;return[o("span",t._g(t._b({staticClass:"theme-color",on:{mouseover:t.handleTooltip,mouseleave:t.handleTooltip}},"span",a,!1),s),[t._v(" "+t._s(t.bookstores.length)+" 間台灣線上電子書店 ")])]}}]),model:{value:t.isTooltipShow,callback:function(e){t.isTooltipShow=e},expression:"isTooltipShow"}},[o("v-layout",{staticClass:"activated-stores-tooltip",attrs:{row:"",wrap:""}},t._l(t.bookstores,(function(e,s){return o("v-flex",{key:s,attrs:{xs6:"","my-2":""}},[o("v-avatar",{attrs:{size:"32"}},[o("img",{attrs:{src:"img/"+e.id+".png",alt:e.displayName}})]),o("span",{staticClass:"ma-2 grey--text text--darken-1"},[t._v(" "+t._s(e.displayName)+" ")]),o("span",{staticClass:"float-right mr-3"},[t._v(" "+t._s(e.isOnline?"🟢":"🔴")+" ")])],1)})),1)],1)],1)])])],1)],1)},T=[],R=s("2909"),O=(s("d3b7"),s("3ca3"),s("ddb0"),s("2b3d"),s("4de4"),s("d81d"),s("a434"),{name:"home",data:function(){return{searchWord:"",isTooltipShow:!1,bookstores:[],validBookstores:[],selectedBookstores:[],apiUrl:""}},mounted:function(){this.getBookstores()},methods:{redirectToSearch:function(){""!==this.searchWord&&this.$router.push({path:"searches",query:{q:this.searchWord,bookstores:this.selectedBookstores}})},getBookstores:function(){var t=this,e=new URL("".concat(this.apiUrl,"/bookstores"));fetch(e).then((function(t){return t.json()})).then((function(e){t.bookstores=e,t.validBookstores=e.filter((function(t){return t.isOnline})),t.selectedBookstores=t.validBookstores.map((function(t){return t.id}))}))},handleTooltip:function(){this.isTooltipShow=!this.isTooltipShow},remove:function(t){this.selectedBookstores.splice(t,1),this.selectedBookstores=Object(R["a"])(this.selectedBookstores)}}}),j=O,L=(s("becd"),s("cc20")),$=s("a523"),D=s("4bd4"),N=s("b974"),W=s("8654"),P=s("3a2f"),U=Object(u["a"])(j,V,T,!1,null,"12bf2931",null),q=U.exports;h()(U,{VAvatar:f["a"],VChip:L["a"],VContainer:$["a"],VFlex:k["a"],VForm:D["a"],VImg:g["a"],VLayout:x["a"],VSelect:N["a"],VTextField:W["a"],VTooltip:P["a"]});var I=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"bg-grey"},[s("v-container",{attrs:{"pb-0":""}},[s("v-layout",{attrs:{row:""}},[s("v-flex",{attrs:{xs12:"","mx-5":"","mt-4":""}},[s("v-form",{ref:"form",on:{submit:function(e){return e.preventDefault(),t.submitSearch(e)}}},[s("v-text-field",{attrs:{placeholder:"搜尋您想比價的電子書名關鍵字或 ISBN","append-icon":"search",solo:"",clearable:""},on:{"click:append":t.submitSearch},model:{value:t.searchWord,callback:function(e){t.searchWord=e},expression:"searchWord"}})],1)],1)],1),s("v-layout",[s("v-flex",{attrs:{xs12:""}},[s("v-select",{attrs:{items:t.validBookstores,"item-text":"displayName","item-value":"id",chips:"",label:"選擇書店","prepend-icon":"filter_list",multiple:"",clearable:""},scopedSlots:t._u([{key:"selection",fn:function(e){var o=e.item,a=e.index;return[s("v-chip",{attrs:{close:""},on:{"click:close":function(e){return t.remove(a)}}},[s("span",[t._v(t._s(o.displayName))])])]}}]),model:{value:t.selectedBookstores,callback:function(e){t.selectedBookstores=e},expression:"selectedBookstores"}})],1)],1)],1)],1),t.isLoading?s("v-container",{staticClass:"loading",attrs:{"grid-list-md":""}},[s("book-loading")],1):t._e(),t.isLoading?t._e():s("v-container",{attrs:{"pb-0":""}},[s("v-flex",{attrs:{"mx-5":"",row:""}},[s("v-flex",{attrs:{xs12:"",sm6:"",md6:"",lg6:""}},[s("v-radio-group",{attrs:{row:""},on:{change:t.sortOnChange},model:{value:t.selectedSort,callback:function(e){t.selectedSort=e},expression:"selectedSort"}},t._l(t.sorts,(function(t,e){return s("v-radio",{key:e,attrs:{label:""+t,value:t}})})),1)],1),s("v-flex",{attrs:{xs12:"",sm6:"",md6:"",lg6:""}},[s("v-card-text",{staticClass:"text-right"},[t._v(" 共有 "+t._s(t.total)+" 筆結果，搜尋時間："+t._s(t.searchResult.searchDateTime)+" "),s("v-btn",{attrs:{color:"primary",text:""},on:{click:t.copySharedLink,mouseleave:t.hiddenShow}},[t._v(" share "),s("v-icon",[t._v(" mdi-share ")])],1),s("span",[s("v-tooltip",{attrs:{right:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,a=e.attrs;return[s("span",t._g(t._b({},"span",a,!1),o))]}}],null,!1,68286429),model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("span",[t._v("Copied!")])])],1)],1)],1)],1),0!==t.total?s("v-tabs",{attrs:{"show-arrows":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(t.bookstoresResults,(function(e,o){return s("v-tab",{key:o},[t._v(" "+t._s(e.bookstore.displayName)+" ")])})),1):t._e(),0!==t.total?s("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(t.bookstoresResults,(function(e,o){return s("v-tab-item",{key:o},[e.books.length?t._e():s("v-flex",[s("span",{staticClass:"result-not-found"},[t._v("查無結果")])]),s("v-container",{attrs:{"grid-list-md":""}},[s("v-layout",{attrs:{row:""}},t._l(e.books,(function(o,a){return s("v-flex",{key:a,attrs:{xs12:"","pa-2":""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs5:"",sm3:"",md2:"",lg2:""}},[s("v-chip",{staticClass:"mb-2",attrs:{small:""}},[s("v-avatar",[s("img",{attrs:{src:"../img/"+e.bookstore.id+".png",alt:e.bookstore.displayName}})]),t._v(" "+t._s(e.bookstore.displayName)+" ")],1),s("a",{attrs:{href:o.link}},[s("v-img",{attrs:{src:o.thumbnail,alt:o.title}})],1)],1),s("v-flex",{attrs:{xs7:"",sm9:"",md10:"",lg10:""}},[s("v-card-title",{staticClass:"pa-2"},[s("h2",{staticClass:"title"},[s("a",{attrs:{href:o.link}},[t._v(t._s(o.title))])])]),s("v-card-text",{staticClass:"subheading pa-2"},[o.authors||o.translators||o.painters||o.painters||o.publisher||o.publishDate?s("ul",{staticClass:"contributor"},[o.authors?s("li",{staticClass:"subheading"},[t._v(" 作者："+t._s(o.authors.join("、"))+" ")]):t._e(),o.translators?s("li",{staticClass:"subheading"},[t._v(" 譯者："+t._s(o.translators.join("、"))+" ")]):t._e(),o.painters?s("li",{staticClass:"subheading"},[t._v(" 繪者："+t._s(o.painters.join("、"))+" ")]):t._e(),o.publisher?s("li",{staticClass:"subheading"},[t._v(" 出版："+t._s(o.publisher)+" ")]):t._e(),o.publishDate?s("li",{staticClass:"subheading"},[t._v(" 出版日期："+t._s(o.publishDate)+" ")]):t._e()]):t._e(),o.about?s("p",[t._v(t._s(o.about.substr(0,150)+"..."))]):t._e(),o.price||o.nonDrmPrice?s("ul",{staticClass:"subheading price-list"},[o.price?s("li",{},[t._v(" 價格："+t._s(o.price)+" "+t._s(o.priceCurrency||"")+" ")]):t._e(),o.nonDrmPrice?s("li",[t._v(" DRM-free 價格："+t._s(o.nonDrmPrice)+" "+t._s(o.priceCurrency||"")+" ")]):t._e()]):t._e()])],1)],1)],1)})),1)],1)],1)})),1):t._e()],1)],1)},E=[],F=s("1da1"),J=(s("96cf"),s("caad"),s("2532"),s("99af"),s("ac1f"),s("841c"),s("5319"),s("159b"),function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)}),A=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bookshelf-wrapper"},[s("ul",{staticClass:"books-list"},[s("li",{staticClass:"book-item first"}),s("li",{staticClass:"book-item second"}),s("li",{staticClass:"book-item third"}),s("li",{staticClass:"book-item fourth"}),s("li",{staticClass:"book-item fifth"}),s("li",{staticClass:"book-item sixth"})]),s("div",{staticClass:"shelf"})])}],M=(s("9d52"),{}),z=Object(u["a"])(M,J,A,!1,null,"1cea359c",null),G=z.exports,H={name:"search",components:{"book-loading":G},data:function(){return{tab:null,isLoading:!1,searchWord:"",selectedSort:"綜合排序",sorts:["綜合排序","價格低至高","價格高至低"],selectedBookstores:[],bookstores:[],validBookstores:[],total:0,searchResult:{},bookstoresResults:[],sharedLink:"",show:!1,apiUrl:""}},mounted:function(){var t=this;return Object(F["a"])(regeneratorRuntime.mark((function e(){var s,o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getBookstores();case 2:if(!t.$route.params.id){e.next=6;break}return o=t.$route.params.id,t.getSearchResult(o),e.abrupt("return");case 6:null!==(s=t.$route.query.bookstores)&&void 0!==s&&s.length?(a=t.validBookstores.filter((function(e){return t.$route.query.bookstores.includes(e.id)})),t.selectedBookstores=a.map((function(t){return t.id}))):t.selectedBookstores=t.validBookstores.map((function(t){return t.id})),t.$route.query.q&&(t.searchWord=t.$route.query.q,t.submitSearch());case 8:case"end":return e.stop()}}),e)})))()},methods:{getBookstores:function(){var t=this;return Object(F["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=new URL("".concat(t.apiUrl,"/bookstores")),e.next=3,fetch(s).then((function(t){return t.json()})).then((function(e){t.bookstores=e,t.validBookstores=e.filter((function(t){return t.isOnline}))}));case 3:case"end":return e.stop()}}),e)})))()},getSearchResult:function(t){var e=this;this.isLoading=!0;var s=new URL("".concat(this.apiUrl,"/searches/").concat(t));fetch(s).then((function(t){return t.json()})).then((function(t){return e.handleSearchResult(t)})).finally((function(){e.isLoading=!1}))},handleSearchResult:function(t){this.searchResult=t,this.total=t.totalQuantity,this.bookstoresResults=JSON.parse(JSON.stringify(t.results)),this.selectedBookstores=this.bookstoresResults.map((function(t){var e=t.bookstore;return e.id})),this.searchWord=t.keywords;var e=t.id;this.sharedLink="".concat(window.location.protocol,"//").concat(window.location.host,"/searches/").concat(e)},submitSearch:function(){var t=this;if(""!==this.searchWord){this.total=0,this.searchResult={},this.bookstoresResults=[],this.isLoading=!0,0===this.selectedBookstores.length&&(this.selectedBookstores=this.validBookstores.map((function(t){return t.id})));var e=new URL("".concat(this.apiUrl,"/searches")),s=new URLSearchParams;s.append("q",this.searchWord),this.selectedBookstores.map((function(t){return s.append("bookstores",t)})),e.search=s,fetch(e,{method:"POST"}).then((function(t){return t.json()})).then((function(e){t.handleSearchResult(e),t.$router.replace({path:"/searches/".concat(e.id)})})).finally((function(){t.isLoading=!1}))}},sortOnChange:function(){"價格低至高"===this.selectedSort?this.bookstoresResults.forEach((function(t){t.books.sort((function(t,e){return t.price-e.price}))})):"價格高至低"===this.selectedSort?this.bookstoresResults.forEach((function(t){t.books.sort((function(t,e){return e.price-t.price}))})):this.bookstoresResults=JSON.parse(JSON.stringify(this.searchResult.results))},remove:function(t){this.selectedBookstores.splice(t,1),this.selectedBookstores=Object(R["a"])(this.selectedBookstores)},copySharedLink:function(){var t=this;return Object(F["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,navigator.clipboard.writeText(t.sharedLink);case 2:t.show=!0;case 3:case"end":return e.stop()}}),e)})))()},hiddenShow:function(){this.show=!1}}},Q=H,K=(s("c391"),s("99d9")),X=s("132d"),Y=s("67b6"),Z=s("43a6"),tt=s("71a3"),et=s("c671"),st=s("fe57"),ot=s("aac8"),at=Object(u["a"])(Q,I,E,!1,null,"09d13406",null),rt=at.exports;h()(at,{VAvatar:f["a"],VBtn:m["a"],VCardText:K["a"],VCardTitle:K["b"],VChip:L["a"],VContainer:$["a"],VFlex:k["a"],VForm:D["a"],VIcon:X["a"],VImg:g["a"],VLayout:x["a"],VRadio:Y["a"],VRadioGroup:Z["a"],VSelect:N["a"],VTab:tt["a"],VTabItem:et["a"],VTabs:st["a"],VTabsItems:ot["a"],VTextField:W["a"],VTooltip:P["a"]}),o["a"].use(B["a"]);var it=new B["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:q},{path:"/searches",name:"search",component:rt},{path:"/searches/:id",name:"searches",component:rt}]});o["a"].config.productionTip=!1,new o["a"]({router:it,vuetify:r,render:function(t){return t(S)}}).$mount("#app")},7289:function(t,e,s){},"9c6c":function(t,e,s){t.exports=s.p+"img/ebook-logo.3464842a.svg"},"9d52":function(t,e,s){"use strict";s("7289")},b0a0:function(t,e,s){"use strict";s("452c")},becd:function(t,e,s){"use strict";s("2d0a")},c391:function(t,e,s){"use strict";s("22e3")},ddae:function(t,e,s){t.exports=s.p+"img/app-store-badge.ccaef5b1.svg"},eca2:function(t,e,s){"use strict";s("109b")}});
//# sourceMappingURL=app.df65a630.js.map